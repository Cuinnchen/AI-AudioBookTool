# 用户工作流差异分析

<cite>
**本文档引用的文件**   
- [README.md](file://README.md)
- [config.json](file://config.json)
- [serverV2.py](file://serverV2.py)
- [index.html](file://index.html)
</cite>

## 目录
1. [新用户与高级用户操作路径对比](#新用户与高级用户操作路径对比)
2. [系统配置灵活性分析](#系统配置灵活性分析)
3. [工作流差异数据路径图示](#工作流差异数据路径图示)
4. [用户模式切换建议](#用户模式切换建议)

## 新用户与高级用户操作路径对比

新用户与高级用户在使用本系统时，遵循着截然不同的操作路径，这主要体现在对系统配置的依赖程度和对自动化流程的利用方式上。

新用户的工作流设计为“快速上手”模式，其核心路径为：**启动服务→上传TXT→自动处理→默认音色生成→一键导出**。这一流程高度依赖前端的向导式界面和后端的默认配置，旨在为用户提供一个零配置、一键式的自动化体验。用户只需上传文本，系统便会自动调用默认的LLM模型（如Gemini）进行章节分割和角色分析，并使用`config.json`中预设的默认TTS模型（如cosyvoice_v2）生成语音，最终实现一键导出。

相比之下，高级用户的工作流则深入到系统的配置层面，其典型路径为：**预先在config.json中设置LLM/TTS密钥与模型参数→上传后手动调整章节分割规则→使用角色管理功能深度分析人物性格→通过替换词典修正专有名词发音→管理音色库实现个性化音色分类→利用临时音色覆盖功能实现特殊场景语音效果**。高级用户不满足于默认配置，而是通过直接编辑`config.json`文件来管理API密钥、代理设置和模型参数，从而获得对处理流程的完全控制。

**Section sources**
- [README.md](file://README.md#L1-L5)
- [config.json](file://config.json#L1-L45)
- [serverV2.py](file://serverV2.py#L1-L2526)
- [index.html](file://index.html#L1-L4203)

## 系统配置灵活性分析

系统通过高度灵活的配置机制支持不同层级的用户需求。其核心在于`config.json`文件的结构化设计和后端API的可扩展性。

在`config.json`文件中，系统定义了`general`、`models`、`tts_models`等多个配置域。`general`部分允许用户设置默认模型和代理，`models`部分则为不同的LLM（如Gemini、阿里云平台）配置了独立的`api_key`、`model_name`和`max_chars`等参数。这使得高级用户可以在处理不同小说时，灵活切换不同的AI模型和参数，以适应不同文本的处理需求。

后端API的设计也体现了这种灵活性。例如，`/api/process_single_chapter`接口接受`model_name`参数，允许用户指定处理章节时使用的LLM模型。`/api/tts_v2`接口则通过`TTSRequestV2`模型，支持`inference_mode`（推理模式）和`instruct_text`（指令文本）等高级参数，使高级用户能够实现“精细”或“指令”模式的语音生成，而新用户则始终使用默认的“普通”模式。

此外，系统通过`/api/upload_timbre`和`/api/timbres/set_category`等API，为高级用户提供了一套完整的音色库管理功能。他们可以上传音色、设置参考文本、并将其分类管理，从而构建一个个性化的音色库。而新用户则只能从预设的音色中选择。

**Section sources**
- [config.json](file://config.json#L1-L45)
- [serverV2.py](file://serverV2.py#L74-L78)
- [serverV2.py](file://serverV2.py#L1728-L1861)

## 工作流差异数据路径图示

```mermaid
flowchart TD
subgraph "新用户路径"
A1[启动服务] --> B1[上传TXT]
B1 --> C1[自动处理]
C1 --> D1[默认音色生成]
D1 --> E1[一键导出]
end
subgraph "高级用户路径"
A2[配置config.json] --> B2[上传TXT]
B2 --> C2[手动调整章节分割]
C2 --> D2[深度角色分析]
D2 --> E2[使用替换词典]
E2 --> F2[管理音色库]
F2 --> G2[临时音色覆盖]
G2 --> H2[生成与导出]
end
B1 --> C1
B2 --> C2
```

**Diagram sources**
- [config.json](file://config.json#L1-L45)
- [serverV2.py](file://serverV2.py#L1081-L1229)
- [index.html](file://index.html#L1407-L1461)

## 用户模式切换建议

为了兼顾新用户的易用性和高级用户的灵活性，建议在系统前端增加一个“快速模式”与“专家模式”的切换开关。该开关应位于全局设置面板中。

当用户选择“快速模式”时，界面应隐藏所有高级配置选项，如LLM模型选择、音色库管理、替换词典等，仅保留“上传”、“处理”、“生成”、“导出”等核心按钮，为新用户提供一个简洁、无干扰的操作环境。

当用户切换到“专家模式”时，系统应完整展示所有高级功能，包括：
- 在“全局设置”中开放`config.json`的详细配置项。
- 在“角色-音色配置”列中启用“角色名管理”和“管理替换词典”按钮。
- 在“音色库”列中启用“管理音色库”和“上传新音色”功能。
- 在内容编辑器中，为每一行对话开放“模式选择”和“指令文本”输入框。

此切换机制将有效降低新用户的学习成本，同时确保高级用户能够访问其所需的所有功能，从而提升整体用户体验。

**Section sources**
- [index.html](file://index.html#L566-L672)
- [index.html](file://index.html#L462-L464)
- [index.html](file://index.html#L482-L484)